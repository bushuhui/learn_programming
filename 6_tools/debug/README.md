# Debug技巧

如何快速发现程序当中的问题，并找到解决办法，是一项非常重要的技能。下面列了一些常用的方法，大家可以先了解，在遇到问题的时候，琢磨哪种方法比较适合，以及如何灵活应该各类方法去解决所面临的问题。

## 0. 流程分析

其实最快的Debug方式是用自己的大脑去运行程序，然后分析各个变量的变化、时序、函数调用关系等等。可能刚开始对程序进行流程分析太难，因为还没有建立起程序分析的能力，因此建议各位强迫自己先从程序阅读分析开始着手。

程序分析的基本思路：

1. 程序本质上是一个树，功能、函数大多数情况下可以细分成更小的函数、模块等。因此需要锻炼层层深入分析的能力，就是不要把程序当做一个平行的东西，而是根据程序中模块、类、函数等关系，层层深入进去去看、去分析。例如，先把`main`里面的调用看完，这时候先不要急着深入进去看不清楚的函数或者类，而是把main都看完之后，然后再逐个深入进去分析。也就是说采用广度优先的遍历方式去看、去分析代码。

2. 在看当前函数、或者类的时候，先集中精力在所关注的函数、类，它所调用的其他函数、类，需要先假设调用的那些函数、类是符合预期设计。当看完当前的函数、类之后，在对所调用的函数、类直接的调用关系、参数传递、返回值等进行分析。

   

## 1. backtrace

对于C、C++程序，内存访问异常是最常见的一类问题。遇到程序内存访问异常导致的崩溃，不用害怕，目前编程语言、操作系统、IDE都有很好的支持，能够很快的定位到出现的问题地方。



## 2. 单步跟踪

我们在编程的时候，有些非语法问题可能很难找到定位，这时候我们就需要进行程序的调试工作了。一般我们都会在程序加断点，然后再利用单步调试查看变量的值是否异常。



1 - 我们打开Qt界面程序的主窗口

我们将编辑的窗口切换到Debug的窗口

点击那个甲虫的标志

![img](images/qtcreator_debug_01.png)



2 - 下面绿色的播放按钮是编译运行，带甲虫标志的是调试编译运行

在右上角我们可以看到变量值的信息


3 - 不过这时我们发现调试程序也是很快就运行完了

那个变量窗口也是什么信息都没有

那是因为我们没加断点，程序很快就运行结束了

![img](images/qtcreator_debug_02.png)



4 - 我们在程序的适当位置添加断点

然后再点击编译运行

发现程序黄色的进度条停止在断点那里

而变量窗口也有我们需要的信息了

我们可以单击下面的单步运行查看变量值的变化是否正确

![img](images/qtcreator_debug_03.png)



5 - 我们在变量窗口点击Add 可以添加那里原本没有的变量

![img](images/qtcreator_debug_04.png)



6 - 比如我们这里只显示了结构体指针p的值，而没有显示p[1]的值

我们可以输入p[1]，就行了

![img](images/qtcreator_debug_05.png)



7 - 可以看到，在变量窗口已经显示出了p[1]的值了

![img](images/qtcreator_debug_06.png)

## 3. log文件分析

